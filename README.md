# CS225_SpatialComputation_U-ASK_Group_Project

# CS225 Spatial Computing Final Project – Option 3

This project replicates the code and experiments presented in the paper:

> Liu, Yongyi, and Amr Magdy. "U-ASK: a unified architecture for kNN spatial-keyword queries supporting negative keyword predicates." Proceedings of the 30th International Conference on Advances in Geographic Information Systems, 2022.

The focus is on implementing the POWER query processing algorithm for TKQN (Top-k kNN Query with Negative keyword predicates) queries using a hybrid indexing architecture (TEQ) that integrates spatial (quadtree) and textual (inverted index) components.

---

## Overview

The project covers:
- **Paper Review:** Summarizes the proposed query problems (TKQN and BKQN), the U-ASK architecture, and the POWER algorithm.
- **Code Replication:** Implements the indexing (TEQ) and query processing (POWER) components in Python.
- **Experimentation:** Replicates experimental evaluations from the paper, particularly focusing on TKQN query evaluation.

---

## Project Structure

```
.
├── src
│   ├── main.py              # Main entry point to run experiments
│   ├── read_data.py         # Module to load and preprocess data
│   ├── point.py             # Spatial point representation
│   ├── quadTreeNode.py      # Implementation of quadtree nodes for spatial partitioning
│   ├── invertedIndex.py     # Builds and manages the inverted textual index (TEQ)
│   ├── query.py             # Handles query formation and processing
│   ├── power.py             # Implements the POWER query processing algorithm for TKQN queries
│   ├── power_batch.py       # Batch mode execution for experiments
│   └── plots.py             # Generates plots for experimental results
└── exps
    ├── exp_a.py             # Experiment script (option a)
    ├── exp_b.py             # Experiment script (option b)
    ├── exp_c.py             # Experiment script (option c)
    ├── exp_d.py             # (Deprecated: Not used for POWER algorithm)
    ├── exp_e.py             # Experiment script (option e)
    └── exp_f.py             # Experiment script (option f)
```

---

## How to Run

Navigate to the project root directory and run the main script. The basic command-line usage is:

```bash
python main.py --exp=<exp_name> --size=<dataset_size>
```

- **`<exp_name>`:** Experiment identifier (choose from: `a`, `b`, `c`, `d`, `e`, `f`).  
  *Default is `a` if not specified.*
- **`<dataset_size>`:** Specifies the dataset size (options: `2`, `4`, `6`, `8`, `10`).  
  *Default is `4` if not specified.*

Example:

```bash
python main.py --exp=a --size=4
```

---

## Project Details

### Paper & Problem Description

- **TKQN Query:**  
  Input format:  
  `qt = (qt.loc, qt.pos, qt.neg, qt.λ, qt.k)`  
  Combines spatial proximity and textual relevance, with negative keyword filtering.

- **Indexing Architecture (TEQ):**  
  A hybrid structure that uses a quadtree for spatial partitioning and an inverted index for managing keywords. Each leaf node stores:
  - A pointer to a location table on disk.
  - A list of spatial neighboring cells.
  - A textual inverted index with additional metadata (e.g., keyword frequency, maximum weight).
  - An object textual index mapping object IDs to full text.

- **POWER Algorithm:**  
  Implements a parallel, bottom-up search with incremental pruning:
  - Utilizes a master-worker framework where each worker processes local top-k queries.
  - Incorporates a threshold algorithm (TA) to retrieve and aggregate scores efficiently.
  - Evaluates both positive and negative keyword predicates.

### Experimental Setup

Experiments were conducted to evaluate:
1. The effect of query keywords (varying number of positive and negative words/phrases).
2. The effect of the weighting factor (λ) on the balance between spatial and textual scores.
3. The impact of the answer size (q.k) and multi-threading efficiency.
4. The scalability across different dataset sizes.

Plots for these evaluations are generated by the `plots.py` module.

---

## Acknowledgements

The project team thanks Professor Amr Magdy, Dr. Yongyi Liu, TA Alhassan Satii Alshareedah, and others for their invaluable guidance throughout the course.

**Team #11:**
- Kelvin Chou – Paper review, Experiments implementation, README.md
- Kunyi Yu – Paper review, code decomposition, experiments implementation, report writing
- Mona Ibrahim – Paper review, initial code versions

---

## References

[1] Liu, Yongyi, and Amr Magdy. "U-ASK: a unified architecture for kNN spatial-keyword queries supporting negative keyword predicates." *Proceedings of the 30th International Conference on Advances in Geographic Information Systems*, 2022.
